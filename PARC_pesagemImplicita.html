<!doctype html>
<html lang="br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>pesagem implícita</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Sistemática Filogenética e métodos baseados em modelos</a>
        <div class="btn-group">
          <button type="button" class="btn btn-danger">Introdução</button>
          <button type="button" class="btn btn-danger dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
            <span class="visually-hidden">Toggle Dropdown</span>
          </button>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="index.html">Início</a></li>
            <li><a class="dropdown-item" href="int_objetivos.html">Objetivos</a></li>
            <li><a class="dropdown-item" href="int_ementa.html">Ementa</a></li>
            <li><a class="dropdown-item" href="int_programa.html">Programa</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="int_referencias.html">Referências bibliográficas</a></li>
          </ul>
        </div>
        <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Classificações
              </a>
              <ul class="dropdown-menu dropdown-menu-dark">
                <li><a class="dropdown-item" href="class_objetivos.html">Objetivos</a></li>
                <li><a class="dropdown-item" href="class_exercicios.html">Para refletir e responder...</a></li>
                <li><a class="dropdown-item" href="class_subordina.html">Preparando uma classificação por subordinação</a></li>
                <li><a class="dropdown-item" href="class_seque.html">Preparando uma classificação por sequenciação</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Sistemática filogenética (Cladística)
              </a>
              <ul class="dropdown-menu dropdown-menu-dark">
                  <li><a class="dropdown-item" href="PARC_objetivos.html">Objetivos</a></li>
                  <li><a class="dropdown-item" href="#">Morfologia: busca TRADICIONAL pelo TNT</a></li>
                  <li><a class="dropdown-item" href="#">Morfologia: Busca com o uso de "NEW TECHNOLOGY" pelo TNT</a></li>
                  <li><a class="dropdown-item" href="PARC_moleculaTNT.html">DNA e RNA: Busca de árvores pelo TNT</a></li>
                  <li><a class="dropdown-item" href="PARC_bootBremer.html">Índices de suporte (bootstrap e Índice de Bremer) no TNT</a></li>
                  <li><a class="dropdown-item" href="PARC_pesagemImplicita.html">Pesagem implícita (Implied weighting)</a></li>
                  <li><a class="dropdown-item text-wrap" href="PARC_sensit.html">Análise de sensitividade com o uso de diferentes valores de K determinados pela matriz de caracteres</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><a class="dropdown-item" href="PARC_referencias.html">Referências</a></li>
              </ul>
           </li>
           <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Métodos baseados em modelos
              </a>
              <ul class="dropdown-menu dropdown-menu-dark">
                  <li><a class="dropdown-item" href="MOD_objetivos.html">Objetivos</a></li>
                  <li><a class="dropdown-item text-wrap" href="MOD_alinhamento.html">Alinhamento de sequências</a></li>
                  <li><a class="dropdown-item text-wrap" href="MOD_partition.html">Escolha de modelos de evolução molecular no IQ-TREE e melhores esquemas de partição</a></li>
                  <li><a class="dropdown-item text-wrap" href="MOD_verossimil.html">Busca de árvores no IQTree e índice de suporte (máxima verossimilhança)</a></li>
                  <li><a class="dropdown-item text-wrap" href="#">Preparação dos dados e busca de árvores pelo MrBayes (Bayesianismo)</a></li>
                  <li><a class="dropdown-item text-wrap" href="#">Escolha de melhor modelo com integração termodinâmica e fator de Bayes</a></li>
                  <li><a class="dropdown-item text-wrap" href="#">Bayesianismo e evidência total (matriz com caracteres baseados em morfologia e em sequências de DNA)</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><a class="dropdown-item" href="#">Referências</a></li>
              </ul>
          </li>
          </ul>
        </div>
      </div>
  </nav>

  <!---- Exercícios -->
  <div>
    <p class="fs-2 text-success">First things first</p>
    <ol>
        <li class="fs-4 fw-normal">Crie um diretório de trabalho na raiz do seu computador. Evite muitos subdiretórios.</li>
        <li class="fs-4 fw-normal">Certifique-se que o arquivo executável do TNT e seu material estejam dentro do mesmo subdiretório. </li>        
    </ol>
  </div>

  <div>
    <p class="fs-3 text-success">Pesagem implícita: constante <i>K</i></p>
    <p>Diferentemente do procedimento de <strong>ponderação sucessiva</strong> (FARRIS, 1969), GOLOBOFF (1993) criou um método onde não há critério de otimização e não há iterações (isto é, não há a necessidade de fazer uma busca, pesar os caracteres, fazer outra busca, pesar de novo, repetindo o procedimento até atingir a auto-consistência. A pesagem, na verdade, acontece durante a busca, e a ideia geral é que quanto mais homoplasias existirem, menor é o peso dado a elas.</p>
    <div class="text-danger fw-normal">Os pesos são ajustados com base numa função côncava, que apresenta diferentes graus de concavidade de acordo com o valor da constante <i>K</i>, conforme a figura abaixo:</div>
    <p></p>
    <img src="Convex-linear-and-concave-weighting-functions.png" class="rounded mx-auto d-block" alt="função"> 
  </div>

  <div class="accordion" id="accordionExample">
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingOne">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          Código para uma análise com pesagem implícita
        </button>
      </h2>
      <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
        <div class="accordion-body">
          <strong>Uma análise básica para busca tradicional de árvores mais parcimoniosas com pesagem implícita (<i>implicit weighting</i>) usando-se um valor de <i>K</i> = 3</strong>. A busca será realizada com o uso de 700 RAS em cada réplica, mantendo 150 árvores na memória em cada busca, seguida de uma busca tbr.
          <ol>
            <li class="fs-4 fw-normal">Abrir uma janela de comando, entrar no subdiretório de trabalho já criado e digitar<code>./tnt.exe</code> no Windows;</li>
            <li class="fs-4 fw-normal"><code>mxram 2000;</code> [aumenta espaço de memória RAM]</li>
            <li class="fs-4 fw-normal"><code>piwe-;</code> [cancela qualquer esquema de pesagem implícita existente]</li>
            <li class="fs-4 fw-normal"><code>proc NOME_DA_MATRIZ_DE_CARACTERES;</code> [carrega a matriz de caracteres]</li>
            <li class="fs-4 fw-normal"><code>hold 99999;</code> [define buffer de árvores para salvar até <strong>99999</strong> árvores]</li>
            <li class="fs-4 fw-normal"><code>piwe=3;</code> [ajuste do valor de <i>K</i>]</li>
            <li class="fs-4 fw-normal"><code>mult 700 = hold 150 tbr;</code> [busca com 700 RAS, mantendo 150 na memória a cada réplica]</li>
            <li class="fs-4 fw-normal"><code>bb = tbr;</code> [com as árvores retidas na memória, fazer uma busca do tipo <i>tree-bissection-reconnection</i> (tbr)]</li>
            <p></p>
            <p>Se for encontrada mais de uma árvore...</p>
            <li class="fs-4 fw-normal"><code>nelsen*;</code> [calcula consenso estrito, se houver mais de uma árvore]</li>
            <li class="fs-4 fw-normal"><code>tsave *consenso.tre;</code> [abre arquivo de árvore e mantém apenas a última árvore na memória]</li>
            <li class="fs-4 fw-normal"><code>save {strict};</code> [salva a árvore]</li>
            <li class="fs-4 fw-normal"><code>tsave/ ;</code> [fecha o arquivo]</li>
            <li class="fs-4 fw-normal"><code>export = Trees_MP_newick.tre;</code> [exporta a árvore para ser lida em softwares como o FigTree]</li>
            <li class="fs-4 fw-normal"><code>ttags =;</code> [exporta a árvore para ser lida em .svg]</li>
            <li class="fs-4 fw-normal"><code>ttag & strictTree.svg;</code> [salva a árvore]</li>
            <li class="fs-4 fw-normal"><code>taxname=;</code> [coloca os nomes dos táxons]</li>           
            <p></p>
            <p>Caso contrário...</p>
            <li class="fs-4 fw-normal"><code>tsave tree1.tmp;</code> [abre arquivo de árvore]</li>
            <li class="fs-4 fw-normal"><code>save 0;</code> [salva a árvore #0: lembre-se que o TNT começa a contar no algarismo 0!]</li>
            <li class="fs-4 fw-normal"><code>tsave/ ;</code> [fecha o arquivo]</li>
            <li class="fs-4 fw-normal"><code>export = Tree_MP_newick.tre;</code> [exporta a árvore para ser lida em softwares como o FigTree]</li>
            <li class="fs-4 fw-normal"><code>ttags =;</code> [exporta a árvore para ser lida em .svg]</li>
            <li class="fs-4 fw-normal"><code>ttag & Tree_0.svg;</code> [salva a árvore]</li>
            <li class="fs-4 fw-normal"><code>taxname=;</code> [coloca os nomes dos táxons]</li>
            <p></p>
            <li class="fs-4 fw-normal"><code>zzz;</code> [finaliza o TNT, caso queira]</li>
          </ol>          
          <p></p>
          <p class="fw-light font-monospace">Tente fazer com outros valores de <i>K</i>, comparando as topologias obtidas.</p>

        </div>
      </div>
    </div>   
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingTwo">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          Exercícios
        </button>
      </h2>
      <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
        <div class="accordion-body">
          <ul>
            <li><p class="fst-italic fs-6">O que acontecerá se diminuirmos o valor de K?</p></li>
            <li><p class="fst-italic fs-6">O que acontecerá se aumentarmos o valor de K?</p></li>
            <li><p class="fst-italic fs-6">O que acontece com o ajuste da árvore com a diminuição do valor de K?</p></li>
          </ul>
        </div>
      </div>
    </div> 
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
  </body>
</html>